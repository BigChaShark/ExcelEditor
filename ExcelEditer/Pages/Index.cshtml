@page
@model IndexModel
@{
    ViewData["Title"] = "Upload File";
}

<h2>Upload File</h2>

<form method="post" enctype="multipart/form-data">
    <input type="file" asp-for="UploadedFile" />
    <button type="submit" asp-page-handler="ProcessExcel">Upload & Process</button>
</form>

@* <form method="post"> *@
@*     <button type="submit">Test DB</button> *@
@* </form> *@

@if (Model.UploadedFile != null)
{
    <p id="upload-success-msg">File uploaded successfully: @Model.UploadedFile.FileName</p>
}
@if (Model.ShowDownloadButton)
{
    <div class="mt-3" id="download-button-container">
        <a asp-page-handler="DownloadFile" class="btn btn-success">Download Processed File</a>
    </div>
}
<script>
    document.querySelector('input[type="file"]').addEventListener('change', function () {
        const downloadBtn = document.getElementById('download-button-container');
        if (downloadBtn) {
            downloadBtn.style.display = 'none';
        }
        const successMsg = document.getElementById('upload-success-msg');
        if (successMsg) {
            successMsg.style.display = 'none';
        }
    });
</script>